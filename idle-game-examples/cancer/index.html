<html>

<head>
	<title>The Cancer Idle</title>
</head>

<body>
	<small>source code on <a href="https://github.com/Dimava/dimava.github.io/blob/master/idle-game-examples/cancer/index.html">Github</a></small>

	<!-- writing game elements in html is ok, and is a common practice -->
	<div id="elCoinsContainer"> Coins: <span id="elCoins"></span> </div>
	<div id="elWorkerContainer"> Workers: <span id="elWorkerCount"></span> </div>
	<br>
	<!-- using onclick in html is cancer, but is a common practice -->
	<button onclick="game.getCoin()"> Get a coin </button>
	<button onclick="game.getWorker()"> Get a worker (<span id="elWorkerCost"></span> coins)</button>
	<br>
	<div id="elEndGame"> There is no more content in the game </div>
	<button style="float: right;" onclick="game.clearSave()"> Reset game </button>

	<!-- using inline <script> tags is an common practice -->
	<script>
		/** everything that saves goes here */
		var data = {
			coins: 0,
			workers: 0,
		};
		/** everything that is function goes here */
		var game = {
			/** everything that updates goes here */
			tick() {
				data.coins += data.workers;

				game.updateDisplay();
			},
			/** everything that draws goes here */
			updateDisplay() {
				// finding elements as `window[id]` (or just `id`) is cancer, but it is simple and does work
				// using `element.innerText` is a good practice
				// using `element.hidden` is an okay practice
				// updating every every tick may be cancer if you do over 10000 element updates per second
				elCoins.innerText = data.coins;
				elWorkerContainer.hidden = data.workers == 0 && !game.canGetWorker();
				elWorkerCost.innerText = game.getWorkerCost();
				elWorkerCount.innerText = data.workers;
				elEndGame.hidden = data.workers < 2;
			},

			getCoin() {
				data.coins++;
				game.updateDisplay();
			},

			getWorkerCost() {
				return data.workers + 10;
			},
			canGetWorker() {
				return data.coins >= game.getWorkerCost();
			},
			getWorker() {
				if (game.canGetWorker()) {
					data.coins -= game.getWorkerCost();
					data.workers++;
				}
				game.updateDisplay();
			},

			// theese three 
			save(savename = 'cancersave') {
				localStorage.setItem(savename, JSON.stringify(data));
			},
			load(savename = 'cancersave') {
				Object.assign(data, JSON.parse(localStorage.getItem(savename) || '{}'));
				game.tick();
				game.updateDisplay();
			},
			clearSave(savename = 'cancersave') {
				localStorage.setItem(savename, '{}');
				location.reload();
			}
		}
		game.load();
		// using setInterval is an okay practice, it has its own features and problems
		setInterval(() => game.tick(), /* 1 second */ 1e3);
		setInterval(() => game.save(), /* 10 seconds */ 10e3);

	</script>


</body>

</html>